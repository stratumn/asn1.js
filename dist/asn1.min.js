this.asn1=this.asn1||{},this.asn1.js=function(e,t,r,n,i){"use strict";function o(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function s(e,t){this.path=e,this.rethrow(t)}t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,n=n&&n.hasOwnProperty("default")?n.default:n,o.prototype.isError=function(e){return e instanceof s},o.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},o.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},o.prototype.enterKey=function(e){return this._reporterState.path.push(e)},o.prototype.exitKey=function(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)},o.prototype.leaveKey=function(e,t,r){var n=this._reporterState;this.exitKey(e),null!==n.obj&&(n.obj[t]=r)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},o.prototype.leaveObject=function(e){var t=this._reporterState,r=t.obj;return t.obj=e,r},o.prototype.error=function(e){var t=void 0,r=this._reporterState,n=e instanceof s;if(t=n?e:new s(r.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack),!r.options.partial)throw t;return n||r.errors.push(t),t},o.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},t(s,Error),s.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this};var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function u(e,t){o.call(this,t),Buffer.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function c(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){var r=e;return r instanceof c||(r=new c(r,t)),this.length+=r.length,r},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=Buffer.byteLength(e);else{if(!Buffer.isBuffer(e))return t.error("Unsupported type: "+(void 0===e?"undefined":a(e)));this.value=e,this.length=e.length}}t(u,o),u.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},u.prototype.restore=function(e){var t=new u(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,o.prototype.restore.call(this,e.reporter),t},u.prototype.isEmpty=function(){return this.offset===this.length},u.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},u.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var r=new u(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},u.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},c.prototype.join=function(e,t){var r=e,n=t;return r||(r=new Buffer(this.length)),n||(n=0),0===this.length?r:(Array.isArray(this.value)?this.value.forEach(function(e){e.join(r,n),n+=e.length}):("number"==typeof this.value?r[n]=this.value:"string"==typeof this.value?r.write(this.value,n):Buffer.isBuffer(this.value)&&this.value.copy(r,n),n+=this.length),r)};var f=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],l=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(f);function h(e,t){var r={};this._baseState=r,r.enc=e,r.parent=t||null,r.children=null,r.tag=null,r.args=null,r.reverseArgs=null,r.choice=null,r.optional=!1,r.any=!1,r.obj=!1,r.use=null,r.useDecoder=null,r.key=null,r.default=null,r.explicit=null,r.implicit=null,r.contains=null,r.parent||(r.children=[],this._wrap())}var p=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];h.prototype.clone=function(){var e=this._baseState,t={};p.forEach(function(r){t[r]=e[r]});var r=new this.constructor(t.parent);return r._baseState=t,r},h.prototype._wrap=function(){var e=this._baseState;l.forEach(function(t){this[t]=function(){var r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}},this)},h.prototype._init=function(e){var t=this._baseState;r(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),r.equal(t.children.length,1,"Root node can have only one child")},h.prototype._useArgs=function(e){var t=e,n=this._baseState,i=t.filter(function(e){return e instanceof this.constructor},this);t=t.filter(function(e){return!(e instanceof this.constructor)},this),0!==i.length&&(r(null===n.children),n.children=i,i.forEach(function(e){e._baseState.parent=this},this)),0!==t.length&&(r(null===n.args),n.args=t,n.reverseArgs=t.map(function(e){if("object"!==(void 0===e?"undefined":a(e))||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(r){var n=r;n==(0|n)&&(n|=0);var i=e[n];t[i]=n}),t}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(e){h.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),f.forEach(function(e){h.prototype[e]=function(){var t=this._baseState,n=Array.prototype.slice.call(arguments);return r(null===t.tag),t.tag=e,this._useArgs(n),this}}),h.prototype.use=function(e){r(e);var t=this._baseState;return r(null===t.use),t.use=e,this},h.prototype.optional=function(){return this._baseState.optional=!0,this},h.prototype.def=function(e){var t=this._baseState;return r(null===t.default),t.default=e,t.optional=!0,this},h.prototype.explicit=function(e){var t=this._baseState;return r(null===t.explicit&&null===t.implicit),t.explicit=e,this},h.prototype.implicit=function(e){var t=this._baseState;return r(null===t.explicit&&null===t.implicit),t.implicit=e,this},h.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},h.prototype.key=function(e){var t=this._baseState;return r(null===t.key),t.key=e,this},h.prototype.any=function(){return this._baseState.any=!0,this},h.prototype.choice=function(e){var t=this._baseState;return r(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},h.prototype.contains=function(e){var t=this._baseState;return r(null===t.use),t.contains=e,this},h.prototype._decode=function(e,t){var r=this._baseState,n=e;if(null===r.parent)return n.wrapResult(r.children[0]._decode(n,t));var i=r.default,o=!0,s=null;if(null!==r.key&&(s=n.enterKey(r.key)),r.optional){var a=null;if(null!==r.explicit?a=r.explicit:null!==r.implicit?a=r.implicit:null!==r.tag&&(a=r.tag),null!==a||r.any){if(o=this._peekTag(n,a,r.any),n.isError(o))return o}else{var c=n.save();try{null===r.choice?this._decodeGeneric(r.tag,n,t):this._decodeChoice(n,t),o=!0}catch(e){o=!1}n.restore(c)}}var f=void 0;if(r.obj&&o&&(f=n.enterObject()),o){if(null!==r.explicit){var l=this._decodeTag(n,r.explicit);if(n.isError(l))return l;n=l}var h=n.offset;if(null===r.use&&null===r.choice){var p=void 0;r.any&&(p=n.save());var d=this._decodeTag(n,null!==r.implicit?r.implicit:r.tag,r.any);if(n.isError(d))return d;r.any?i=n.raw(p):n=d}if(t&&t.track&&null!==r.tag&&t.track(n.path(),h,n.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(n.path(),n.offset,n.length,"content"),r.any||(i=null===r.choice?this._decodeGeneric(r.tag,n,t):this._decodeChoice(n,t)),n.isError(i))return i;if(r.any||null!==r.choice||null===r.children||r.children.forEach(function(e){e._decode(n,t)}),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){var g=new u(i);i=this._getUse(r.contains,n._reporterState.obj)._decode(g,t)}}return r.obj&&o&&(i=n.leaveObject(f)),null===r.key||null===i&&!0!==o?null!==s&&n.exitKey(s):n.leaveKey(s,r.key,i),i},h.prototype._decodeGeneric=function(e,t,r){var n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0],r):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},h.prototype._getUse=function(e,t){var n=this._baseState;return n.useDecoder=this._use(e,t),r(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},h.prototype._decodeChoice=function(e,t){var r=this._baseState,n=null,i=!1;return Object.keys(r.choice).some(function(o){var s=e.save(),a=r.choice[o];try{var u=a._decode(e,t);if(e.isError(u))return!1;n={type:o,value:u},i=!0}catch(t){return e.restore(s),!1}return!0},this),i?n:e.error("Choice not matched")},h.prototype._createEncoderBuffer=function(e){return new c(e,this.reporter)},h.prototype._encode=function(e,t,r){var n=this._baseState;if(null===n.default||n.default!==e){var i=this._encodeValue(e,t,r);if(void 0!==i&&!this._skipDefault(i,t,r))return i}},h.prototype._encodeValue=function(e,t,r){var n=this._baseState,i=e;if(null===n.parent)return n.children[0]._encode(i,t||new o);var s=null;if(this.reporter=t,n.optional&&void 0===i){if(null===n.default)return;i=n.default}var u=null,c=!1;if(n.any)s=this._createEncoderBuffer(i);else if(n.choice)s=this._encodeChoice(i,t);else if(n.contains)u=this._getUse(n.contains,r)._encode(i,t),c=!0;else if(n.children)u=n.children.map(function(e){if("null_"===e._baseState.tag)return e._encode(null,t,i);if(null===e._baseState.key)return t.error("Child should have a key");var r=t.enterKey(e._baseState.key);if("object"!==(void 0===i?"undefined":a(i)))return t.error("Child expected, but input is not object");var n=e._encode(i[e._baseState.key],t,i);return t.leaveKey(r),n},this).filter(function(e){return e}),u=this._createEncoderBuffer(u);else if("seqof"===n.tag||"setof"===n.tag){if(!n.args||1!==n.args.length)return t.error("Too many args for : "+n.tag);if(!Array.isArray(i))return t.error("seqof/setof, but data is not Array");var f=this.clone();f._baseState.implicit=null,u=this._createEncoderBuffer(i.map(function(e){var r=this._baseState;return this._getUse(r.args[0],i)._encode(e,t)},f))}else null!==n.use?s=this._getUse(n.use,r)._encode(i,t):(u=this._encodePrimitive(n.tag,i),c=!0);if(!n.any&&null===n.choice){var l=null!==n.implicit?n.implicit:n.tag,h=null===n.implicit?"universal":"context";null===l?null===n.use&&t.error("Tag could be omitted only for .use()"):null===n.use&&(s=this._encodeComposite(l,c,h,u))}return null!==n.explicit&&(s=this._encodeComposite(n.explicit,!1,"context",s)),s},h.prototype._encodeChoice=function(e,t){var n=this._baseState,i=n.choice[e.type];return i||r(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),i._encode(e.value,t)},h.prototype._encodePrimitive=function(e,t){var r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},h.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},h.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)};var d=Object.freeze({Node:h,Reporter:o,EncoderBuffer:c,DecoderBuffer:u}),g=function(e){var t={};return Object.keys(e).forEach(function(r){var n=r;(0|n)==n&&(n|=0);var i=e[n];t[i]=n}),t},y={0:"universal",1:"application",2:"context",3:"private"},v=g(y),_={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},b=g(_),m=Object.freeze({tagClass:y,tagClassByName:v,tag:_,tagByName:b}),S=Object.freeze({der:m});function E(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new j,this.tree._init(e.body)}function j(e){h.call(this,"der",e)}function w(e){return e<10?"0"+e:e}function B(e){E.call(this,e),this.enc="pem"}E.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},t(j,h),j.prototype._encodeComposite=function(e,t,r,n){var i=function(e,t,r,n){var i=e,o=void 0;"seqof"===i?i="seq":"setof"===i&&(i="set");if(b.hasOwnProperty(i))o=b[i];else{if("number"!=typeof i||(0|i)!==i)return n.error("Unknown tag: "+i);o=i}if(o>=31)return n.error("Multi-octet tag encoding unsupported");t||(o|=32);return o|=v[r||"universal"]<<6}(e,t,r,this.reporter);if(n.length<128){var o=new Buffer(2);return o[0]=i,o[1]=n.length,this._createEncoderBuffer([o,n])}for(var s=1,a=n.length;a>=256;a>>=8)s++;var u=new Buffer(2+s);u[0]=i,u[1]=128|s;for(var c=1+s,f=n.length;f>0;c--,f>>=8)u[c]=255&f;return this._createEncoderBuffer([u,n])},j.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var r=new Buffer(2*e.length),n=0;n<e.length;n++)r.writeUInt16BE(e.charCodeAt(n),2*n);return this._createEncoderBuffer(r)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)?this._createEncoderBuffer(e):"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},j.prototype._encodeObjid=function(e,t,r){var n=e;if("string"==typeof n){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(n))return this.reporter.error("objid not found in values map");n=t[n].split(/[\s.]+/g);for(var i=0;i<n.length;i++)n[i]|=0}else if(Array.isArray(n)){n=n.slice();for(var o=0;o<n.length;o++)n[o]|=0}if(!Array.isArray(n))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(n));if(!r){if(n[1]>=40)return this.reporter.error("Second objid identifier OOB");n.splice(0,2,40*n[0]+n[1])}for(var s=0,a=0;a<n.length;a++){var u=n[a];for(s++;u>=128;u>>=7)s++}for(var c=new Buffer(s),f=c.length-1,l=n.length-1;l>=0;l--){var h=n[l];for(c[f--]=127&h;(h>>=7)>0;)c[f--]=128|127&h}return this._createEncoderBuffer(c)},j.prototype._encodeTime=function(e,t){var r=void 0,n=new Date(e);return"gentime"===t?r=[w(n.getFullYear()),w(n.getUTCMonth()+1),w(n.getUTCDate()),w(n.getUTCHours()),w(n.getUTCMinutes()),w(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[w(n.getFullYear()%100),w(n.getUTCMonth()+1),w(n.getUTCDate()),w(n.getUTCHours()),w(n.getUTCMinutes()),w(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(r,"octstr")},j.prototype._encodeNull=function(){return this._createEncoderBuffer("")},j.prototype._encodeInt=function(e,t){var r=e;if("string"==typeof r){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(r))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(r));r=t[r]}if("number"!=typeof r&&!Buffer.isBuffer(r)){var n=r.toArray();!r.sign&&128&n[0]&&n.unshift(0),r=new Buffer(n)}if(Buffer.isBuffer(r)){var i=r.length;0===r.length&&i++;var o=new Buffer(i);return r.copy(o),0===r.length&&(o[0]=0),this._createEncoderBuffer(o)}if(r<128)return this._createEncoderBuffer(r);if(r<256)return this._createEncoderBuffer([0,r]);for(var s=1,a=r;a>=256;a>>=8)s++;for(var u=new Array(s),c=u.length-1;c>=0;c--)u[c]=255&r,r>>=8;return 128&u[0]&&u.unshift(0),this._createEncoderBuffer(new Buffer(u))},j.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},j.prototype._use=function(e,t){var r=e;return"function"==typeof r&&(r=r(t)),r._getEncoder("der").tree},j.prototype._skipDefault=function(e,t,r){var n=this._baseState,i=void 0;if(null===n.default)return!1;var o=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,r).join()),o.length!==n.defaultBuffer.length)return!1;for(i=0;i<o.length;i++)if(o[i]!==n.defaultBuffer[i])return!1;return!0},t(B,E),B.prototype.encode=function(e,t){for(var r=E.prototype.encode.call(this,e).toString("base64"),n=["-----BEGIN "+t.label+"-----"],i=0;i<r.length;i+=64)n.push(r.slice(i,i+64));return n.push("-----END "+t.label+"-----"),n.join("\n")};var k=Object.freeze({der:E,pem:B});function O(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new D,this.tree._init(e.body)}function D(e){h.call(this,"der",e)}function U(e,t){var r=e.readUInt8(t);if(e.isError(r))return r;var n=y[r>>6],i=0==(32&r);if(31==(31&r)){var o=r;for(r=0;128==(128&o);){if(o=e.readUInt8(t),e.isError(o))return o;r<<=7,r|=127&o}}else r&=31;return{cls:n,primitive:i,tag:r,tagStr:_[r]}}function C(e,t,r){var n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&128===n)return null;if(0==(128&n))return n;var i=127&n;if(i>4)return e.error("length octect is too long");n=0;for(var o=0;o<i;o++){n<<=8;var s=e.readUInt8(r);if(e.isError(s))return s;n|=s}return n}function T(e){O.call(this,e),this.enc="pem"}O.prototype.decode=function(e,t){var r=e;return r instanceof u||(r=new u(r,t)),this.tree._decode(r,t)},t(D,h),D.prototype._peekTag=function(e,t,r){if(e.isEmpty())return!1;var n=e.save(),i=U(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(n),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||r)},D.prototype._decodeTag=function(e,t,r){var n=U(e,'Failed to decode tag of "'+t+'"');if(e.isError(n))return n;var i=C(e,n.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!r&&n.tag!==t&&n.tagStr!==t&&n.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(n.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');var o=e.save(),s=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(s)?s:(i=e.offset-o.offset,e.restore(o),e.skip(i,'Failed to match body of: "'+t+'"'))},D.prototype._skipUntilEnd=function(e,t){for(;;){var r=U(e,t);if(e.isError(r))return r;var n=C(e,r.primitive,t);if(e.isError(n))return n;var i=void 0;if(i=r.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===r.tagStr)break}},D.prototype._decodeList=function(e,t,r,n){for(var i=[];!e.isEmpty();){var o=this._peekTag(e,"end");if(e.isError(o))return o;var s=r.decode(e,"der",n);if(e.isError(s)&&o)break;i.push(s)}return i},D.prototype._decodeStr=function(e,t){if("bitstr"===t){var r=e.readUInt8();return e.isError(r)?r:{unused:r,data:e.raw()}}if("bmpstr"===t){var n=e.raw();if(n.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");for(var i="",o=0;o<n.length/2;o++)i+=String.fromCharCode(n.readUInt16BE(2*o));return i}if("numstr"===t){var s=e.raw().toString("ascii");return this._isNumstr(s)?s:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){var a=e.raw().toString("ascii");return this._isPrintstr(a)?a:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},D.prototype._decodeObjid=function(e,t,r){for(var n=void 0,i=[],o=0,s=0;!e.isEmpty();)o<<=7,o|=127&(s=e.readUInt8()),0==(128&s)&&(i.push(o),o=0);128&s&&i.push(o);var a=i[0]/40|0,u=i[0]%40;if(n=r?i:[a,u].concat(i.slice(1)),t){var c=t[n.join(" ")];void 0===c&&(c=t[n.join(".")]),void 0!==c&&(n=c)}return n},D.prototype._decodeTime=function(e,t){var r=e.raw().toString(),n=void 0,i=void 0,o=void 0,s=void 0,a=void 0,u=void 0;if("gentime"===t)n=0|r.slice(0,4),i=0|r.slice(4,6),o=0|r.slice(6,8),s=0|r.slice(8,10),a=0|r.slice(10,12),u=0|r.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");n=0|r.slice(0,2),i=0|r.slice(2,4),o=0|r.slice(4,6),s=0|r.slice(6,8),a=0|r.slice(8,10),u=0|r.slice(10,12),n=n<70?2e3+n:1900+n}return Date.UTC(n,i-1,o,s,a,u,0)},D.prototype._decodeNull=function(){return null},D.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},D.prototype._decodeInt=function(e,t){var r=e.raw(),i=new n(r);return t&&(i=t[i.toString(10)]||i),i},D.prototype._use=function(e,t){var r=e;return"function"==typeof r&&(r=r(t)),r._getDecoder("der").tree},t(T,O),T.prototype.decode=function(e,t){for(var r=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),i=/^-----(BEGIN|END) ([^-]+)-----$/,o=-1,s=-1,a=0;a<r.length;a++){var u=r[a].match(i);if(null!==u&&u[2]===n){if(-1!==o){if("END"!==u[1])break;s=a;break}if("BEGIN"!==u[1])break;o=a}}if(-1===o||-1===s)throw new Error("PEM section not found for: "+n);var c=r.slice(o+1,s).join("");c.replace(/[^a-z0-9+/=]+/gi,"");var f=new Buffer(c,"base64");return O.prototype.decode.call(this,f,t)};var N=Object.freeze({der:O,pem:T});function A(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}return A.prototype._createNamed=function(e){var r=void 0;try{r=i.runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){r=function(e){this._initNamed(e)}}return t(r,e),r.prototype._initNamed=function(t){e.call(this,t)},new r(this)},A.prototype._getDecoder=function(e){var t=e||"der";return this.decoders.hasOwnProperty(t)||(this.decoders[t]=this._createNamed(N[t])),this.decoders[t]},A.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},A.prototype._getEncoder=function(e){var t=e||"der";return this.encoders.hasOwnProperty(t)||(this.encoders[t]=this._createNamed(k[t])),this.encoders[t]},A.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)},e.BigNumber=n,e.define=function(e,t){return new A(e,t)},e.constants=S,e.base=d,e.encoders=k,e.decoders=N,e}({},inherits,assert,bignum,vm);
